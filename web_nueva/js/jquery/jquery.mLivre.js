/* mLivre 1.1 de Samuel Mandonnaud <mandonnaud.s gmail com> http://www.le-pret-a-surfer.com/mLivre/ */
(function(a){a.fn.mLivre=function(c,b){switch(c){case"page":a(this).each(function(){var g=a(this);for(var e=0;e<mLivre.donne.length;e++){if(g.is(mLivre.donne[e].$obj)){var f="";if(mLivre.donne[e].page>b){mLivre.clickFc(e,"mLivreLienGauche",b)}else{if(mLivre.donne[e].page<b){mLivre.clickFc(e,"mLivreLienDroite",b)}}}}});return;break;case"suivant":a(this).each(function(){var f=a(this);for(var e=0;e<mLivre.donne.length;e++){if(f.is(mLivre.donne[e].$obj)){mLivre.clickFc(e,"mLivreLienDroite",-1)}}});return;break;case"precedent":a(this).each(function(){var f=a(this);for(var e=0;e<mLivre.donne.length;e++){if(f.is(mLivre.donne[e].$obj)){mLivre.clickFc(e,"mLivreLienGauche",-1)}}});return;break}var d=a.extend({},a.fn.mLivre.defaults,c);a(this).each(function(){var f=a(this);div='<div class="mLivreLienDroite" style="cursor:pointer; height:100%; position:absolute; top:0; right:0; width: 50%; z-index: 10;"></div><div class="mLivreLienGauche" style="cursor:pointer; height:100%; position:absolute; top:0; left:0; width: 50%; z-index: 10;"></div><div class="mLivreEffet" style="position: absolute; top: 0px; height: 100%; width: 100%; z-index: 9;"></div><div class="mLivreAnnim" style="height:100%; position:absolute; top:0; width:50%; z-index:8; overflow:hidden;"></div><div class="mLivreTemp"	style="position:absolute;	top:0; height:100%;	width:50%;	z-index:7; overflow:hidden;"></div><div class="mLivrePrincipal" style="width:100%; height:100%; background:url('+d.dossier+'ajax-loader.gif) no-repeat center center;"></div><img src="'+d.dossier+'effetGauche.png" class="mLivreLoad" /><img src="'+d.dossier+'effetDroite.png" class="mLivreLoad" />';f.addClass("mLivre").css({width:d.width,height:d.height,overflow:"hidden",position:"relative"}).prepend(div);mLivre.donne.push({$obj:f,page:d.pageDefault,opts:d,imgLoad:0,$imgs:f.children("img"),$principle:f.children(".mLivrePrincipal"),$effet:f.children(".mLivreEffet").css({opacity:0}),$annim:f.children(".mLivreAnnim"),$temp:f.children(".mLivreTemp"),$gauche:f.children(".mLivreLienGauche"),$droite:f.children(".mLivreLienDroite"),$liens:f.children(".mLivreLienDroite,.mLivreLienGauche"),d1:{annimLeft:0,annimImgRight:0,annimImgLeft:"",annimRslt:d.width*0.05,tempLeft:0,effetBack:"url("+d.dossier+"effetGauche.png) repeat-y top left",effetLeftRst:(d.width/4),effetLeftRst2:(d.width/2),effetRslt:d.width*0.05,annimLeftRst:(d.width/4),annimLeftRst2:d.width/2,tempLeftRst:0,tempLeftRst2:0,tempRslt:0,coter:"gauche"},d2:{annimLeft:d.width,annimImgRight:"",annimImgLeft:0,annimRslt:d.width*0.9,annimLeftRst:d.width/2,annimLeftRst2:0,width:d.width,tempLeft:d.width,effetBack:"url("+d.dossier+"effetDroite.png) repeat-y top right",effetLeftRst:-(d.width/4),effetLeftRst2:-(d.width/2),effetRslt:-d.width*0.05,tempLeftRst:(d.width/4)*3,tempLeftRst2:d.width/2,tempRslt:d.width*0.95,coter:"droite"}});var e=mLivre.donne.length-1;mLivre.donne[e].$imgs.each(function(){if(!this.complete){mLivre.donne[e].imgLoad++;a(this).one("load",function(g){if(this.className=="mLivreLoad"){a(this).remove()}mLivre.donne[e].imgLoad--;if(mLivre.donne[e].imgLoad==0){mLivre.load(e)}})}else{if(this.className=="mLivreLoad"){a(this).remove()}}});if(mLivre.donne[e].imgLoad==0){mLivre.load(e)}else{mLivre.donne[e].$gauche.hide();mLivre.donne[e].$droite.hide()}f=null})};a.fn.mLivre.defaults={width:300,height:150,pageDefault:0,over:true,eventLoad:null,eventOpen:null,dossier:"mLivre/"}})(jQuery);var mLivre={progress:false,donne:Array(),load:function(a){mLivre.donne[a].$imgs=mLivre.donne[a].$obj.children("img");mLivre.verifExtremite(a);mLivre.donne[a].$principle.html(mLivre.donne[a].$imgs.eq(mLivre.donne[a].page).clone());mLivre.donne[a].$liens.click(function(b){mLivre.clickFc(a,b.currentTarget.className,-1)});if(mLivre.donne[a].opts.over){mLivre.donne[a].$liens.hover(function(b){if(!mLivre.progress){mLivre.overDonne={actif:true,idDonne:a,pile:mLivre.overDonne.pile+1,page:mLivre.donne[a].page};if(b.currentTarget.className=="mLivreLienGauche"){mLivre.overDonne.page--;mLivre.overDonne.d=mLivre.donne[a].d1}else{mLivre.overDonne.page++;mLivre.overDonne.d=mLivre.donne[a].d2}window.setTimeout("mLivre.overFonction()",1000)}},function(){mLivre.overDonne={actif:false,pile:0}})}if(mLivre.donne[a].opts.eventLoad!=null){mLivre.donne[a].opts.eventLoad.apply(mLivre.donne[a].$obj,[])}},verifExtremite:function(a){if(mLivre.donne[a].page==0){mLivre.donne[a].$gauche.hide()}else{mLivre.donne[a].$gauche.show()}if(mLivre.donne[a].page+1==mLivre.donne[a].$imgs.size()){mLivre.donne[a].$droite.hide()}else{mLivre.donne[a].$droite.show()}},clickFc:function(b,c,a){if(mLivre.overProgress=="gauche"&&c=="mLivreLienDroite"||mLivre.overProgress=="droite"&&c=="mLivreLienGauche"){return}mLivre.overDonne={actif:false,pile:0};if(!mLivre.progress){mLivre.progress=true;if(c=="mLivreLienGauche"){mLivre.donne[b].page--;if(a!=-1){mLivre.donne[b].page=a}mLivre.changementPage(b,mLivre.donne[b].d1)}else{mLivre.donne[b].page++;if(a!=-1){mLivre.donne[b].page=a}mLivre.changementPage(b,mLivre.donne[b].d2)}}},preparation:function(a,b,c){mLivre.donne[a].$annim.css({left:c.annimLeft,width:0}).show().html(mLivre.donne[a].$imgs.eq(b).clone()).children("img").css({position:"absolute",right:c.annimImgRight,left:c.annimImgLeft});mLivre.donne[a].$temp.css({left:c.tempLeft,width:0}).show().html(mLivre.donne[a].$imgs.eq(b).clone()).children("img").css({position:"absolute",right:c.annimImgLeft,left:c.annimImgRight});mLivre.donne[a].$effet.css({left:0,background:c.effetBack})},changementPage:function(a,b){if(mLivre.donne[a].page==-1){mLivre.donne[a].page=0;mLivre.progress=false;return}if(mLivre.donne[a].page==mLivre.donne[a].$imgs.size()){mLivre.donne[a].page=mLivre.donne[a].$imgs.size()-1;mLivre.progress=false;return}if(mLivre.overProgress!=b.coter){mLivre.preparation(a,mLivre.donne[a].page,b)}mLivre.donne[a].$gauche.hide();mLivre.donne[a].$droite.hide();mLivre.donne[a].$effet.stop(true).animate({left:b.effetLeftRst,opacity:0.6},300,"linear").animate({left:b.effetLeftRst2,opacity:0},300,"linear");mLivre.donne[a].$annim.stop(true).animate({left:b.annimLeftRst,width:(mLivre.donne[a].opts.width/4)},300,"linear").animate({left:b.annimLeftRst2,width:(mLivre.donne[a].opts.width/2)},300,"linear");mLivre.donne[a].$temp.stop(true).animate({left:b.tempLeftRst,width:(mLivre.donne[a].opts.width/4)},300,"linear").animate({left:b.tempLeftRst2,width:(mLivre.donne[a].opts.width/2)},300,"linear",function(){mLivre.verifExtremite(a);mLivre.donne[a].$principle.html(mLivre.donne[a].$imgs.eq(mLivre.donne[a].page).clone());mLivre.donne[a].$annim.hide();mLivre.donne[a].$temp.hide();mLivre.overProgress="non";mLivre.progress=false});if(mLivre.donne[a].opts.eventOpen!=null){mLivre.donne[a].opts.eventOpen.apply(mLivre.donne[a].$obj,[mLivre.donne[a].page])}},overProgress:"non",overDonne:{actif:false,pile:0},overFonction:function(){mLivre.overDonne.pile--;if(mLivre.overDonne.pile==0){if(mLivre.overDonne.actif&&mLivre.overDonne.page!=-1&&mLivre.overDonne.page!=mLivre.donne[mLivre.overDonne.idDonne].$imgs.size()){if(mLivre.overProgress=="non"){mLivre.preparation(mLivre.overDonne.idDonne,mLivre.overDonne.page,mLivre.overDonne.d);mLivre.overProgress=mLivre.overDonne.d.coter;mLivre.overChangementPage(mLivre.overDonne.idDonne,mLivre.overDonne.d)}}}},overChangementPage:function(a,b){mLivre.donne[a].$annim.animate({left:b.annimRslt,width:mLivre.donne[a].opts.width*0.05},200,"linear").delay(600).animate({left:b.annimLeft,width:0},200,"linear");mLivre.donne[a].$temp.animate({left:b.tempRslt,width:mLivre.donne[a].opts.width*0.05},200,"linear").delay(600).animate({left:b.tempLeft,width:0},200,"linear");mLivre.donne[a].$effet.animate({left:b.effetRslt,opacity:0.4},200,"linear").delay(600).animate({left:0,opacity:0},200,"linear",function(){mLivre.overProgress="non"})}};